#!/bin/sh

# Pre-commit hook: ensures code is always clean before committing
echo "ğŸ” Running pre-commit checks..."

# Step 1: Run lint to check for errors
echo "ğŸ“‹ Step 1/4: Linting code..."
pnpm -s lint || {
  echo "âŒ Linting failed! Please fix the issues above."
  exit 1
}

# Step 2: Auto-fix linting issues
echo "ğŸ”§ Step 2/4: Auto-fixing lint issues..."
pnpm -s lint:fix || {
  echo "âŒ Auto-fix failed! Please review and fix manually."
  exit 1
}

# Step 3: Format code
echo "âœ¨ Step 3/4: Formatting code..."
pnpm -s format || {
  echo "âŒ Formatting failed! Please check for syntax errors."
  exit 1
}

# Step 4: Type checking
echo "ğŸ” Step 4/4: Checking TypeScript types..."
pnpm -s type-check || {
  echo "âŒ Type checking failed! Please fix type errors above."
  exit 1
}

echo "âœ… All pre-commit checks passed! Code is clean and ready to commit."
